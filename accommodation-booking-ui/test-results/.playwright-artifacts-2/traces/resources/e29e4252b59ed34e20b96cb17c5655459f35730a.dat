import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/admin/AdminListingPage.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=be4f383c"; const Fragment = __vite__cjsImport0_react_jsxDevRuntime["Fragment"]; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
var _s = $RefreshSig$();
import __vite__cjsImport1_react from "/node_modules/.vite/deps/react.js?v=be4f383c"; const useState = __vite__cjsImport1_react["useState"]; const useEffect = __vite__cjsImport1_react["useEffect"];
import { useNavigate, useParams } from "/node_modules/.vite/deps/react-router-dom.js?v=be4f383c";
import { Box, Card, CardContent, CircularProgress, Alert, IconButton, Menu, MenuItem, Dialog, DialogTitle, DialogContent, DialogContentText, DialogActions, Button } from "/node_modules/.vite/deps/@mui_material.js?v=be4f383c";
import MoreVertIcon from "/node_modules/.vite/deps/@mui_icons-material_MoreVert.js?v=be4f383c";
import CancelIcon from "/node_modules/.vite/deps/@mui_icons-material_Cancel.js?v=be4f383c";
import EventBusyIcon from "/node_modules/.vite/deps/@mui_icons-material_EventBusy.js?v=be4f383c";
import { ReservationsSection, ReviewsSection } from "/src/components/host/index.js";
import { ListingDetailsSection, ListingGallerySection } from "/src/components/shared/index.js";
import { useAuth, useListingsApi, useReservationsApi, useReviewsApi } from "/src/hooks/index.js";
import { PRIMARY_BLUE, DARK_GRAY } from "/src/assets/styles/colors.js";
import { toast } from "/node_modules/.vite/deps/react-toastify.js?v=be4f383c";
const AdminListingPage = () => {
  _s();
  const navigate = useNavigate();
  const { id } = useParams();
  const { auth } = useAuth();
  const {
    getListing,
    deleteListing,
    loading: listingLoading,
    error: listingError
  } = useListingsApi();
  const { getReservations, updateReservationStatus, loading: reservationsLoading } = useReservationsApi();
  const { getReviews, loading: reviewsLoading } = useReviewsApi();
  const [listing, setListing] = useState(null);
  const [images, setImages] = useState([]);
  const [reviews, setReviews] = useState([]);
  const [reservations, setReservations] = useState([]);
  const [anchorEl, setAnchorEl] = useState(null);
  const [selectedReservation, setSelectedReservation] = useState(null);
  const [confirmDialogOpen, setConfirmDialogOpen] = useState(false);
  const [newStatus, setNewStatus] = useState(null);
  const fetchData = async () => {
    if (!auth?.token || !id) return;
    const listingResult = await getListing(id, auth.token);
    if (listingResult.success) {
      setListing(listingResult.data);
      if (listingResult.data.photos && listingResult.data.photos.length > 0) {
        setImages(listingResult.data.photos);
      } else {
        setImages([]);
      }
    }
    const reservationsResult = await getReservations({ listingId: id }, auth.token);
    if (reservationsResult.success) {
      setReservations(reservationsResult.data);
    }
    const reviewsResult = await getReviews({ listingId: id }, auth.token);
    if (reviewsResult.success) {
      setReviews(reviewsResult.data);
    }
  };
  useEffect(() => {
    fetchData();
  }, [id, auth?.token]);
  const handleEdit = () => {
    navigate(`/admin/listing/${id}/edit`);
  };
  const handleDelete = async () => {
    if (!window.confirm("Czy na pewno chcesz usunąć to ogłoszenie?")) {
      return;
    }
    const result = await deleteListing(id, auth.token);
    if (result.success) {
      toast.success("Ogłoszenie zostało usunięte");
      navigate("/admin/listings");
    } else {
      toast.error(result.error || "Nie udało się usunąć ogłoszenia");
    }
  };
  const handleReviewUpdated = () => {
    fetchData();
  };
  const handleReviewDeleted = () => {
    fetchData();
  };
  const canChangeStatus = (reservation) => {
    const status = reservation.status?.toLowerCase();
    return status !== "completed" && status !== "cancelled" && status !== "noshow";
  };
  const canMarkAsNoShow = (reservation) => {
    return reservation.status?.toLowerCase() === "inprogress";
  };
  const handleMenuOpen = (event, reservation) => {
    setAnchorEl(event.currentTarget);
    setSelectedReservation(reservation);
  };
  const handleMenuClose = () => {
    setAnchorEl(null);
  };
  const handleStatusChangeClick = (status) => {
    setNewStatus(status);
    setConfirmDialogOpen(true);
    handleMenuClose();
  };
  const handleConfirmStatusChange = async () => {
    if (!selectedReservation || !newStatus || !auth?.token) return;
    setConfirmDialogOpen(false);
    const result = await updateReservationStatus(selectedReservation.id, newStatus, auth.token);
    if (result.success) {
      toast.success("Status rezerwacji został zaktualizowany");
      fetchData();
    } else {
      toast.error(result.error || "Nie udało się zaktualizować statusu");
    }
    setSelectedReservation(null);
    setNewStatus(null);
  };
  const handleCancelDialog = () => {
    setConfirmDialogOpen(false);
    setSelectedReservation(null);
    setNewStatus(null);
  };
  const getNewStatusLabel = (status) => {
    switch (status) {
      case "Cancelled":
        return "Anulowana";
      case "NoShow":
        return "Nieodbyta";
      default:
        return status;
    }
  };
  const reservationsWithActions = reservations.map((reservation) => {
    return {
      ...reservation,
      statusAction: canChangeStatus(reservation) ? /* @__PURE__ */ jsxDEV(
        IconButton,
        {
          size: "small",
          onClick: (e) => handleMenuOpen(e, reservation),
          sx: {
            color: PRIMARY_BLUE,
            "&:hover": {
              backgroundColor: "rgba(13, 110, 253, 0.08)"
            }
          },
          children: /* @__PURE__ */ jsxDEV(MoreVertIcon, { fontSize: "small" }, void 0, false, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 162,
            columnNumber: 11
          }, this)
        },
        void 0,
        false,
        {
          fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
          lineNumber: 152,
          columnNumber: 7
        },
        this
      ) : null
    };
  });
  if (listingLoading || reservationsLoading || reviewsLoading) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { display: "flex", justifyContent: "center", alignItems: "center", py: 10 }, children: /* @__PURE__ */ jsxDEV(CircularProgress, {}, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 171,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 170,
      columnNumber: 7
    }, this);
  }
  if (listingError) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: /* @__PURE__ */ jsxDEV(Alert, { severity: "error", children: listingError }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 179,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 178,
      columnNumber: 7
    }, this);
  }
  if (!listing) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: /* @__PURE__ */ jsxDEV(Alert, { severity: "info", children: "Nie znaleziono ogłoszenia" }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 187,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 186,
      columnNumber: 7
    }, this);
  }
  return /* @__PURE__ */ jsxDEV(Fragment, { children: [
    /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: [
      /* @__PURE__ */ jsxDEV(Card, { sx: { mb: 3 }, children: /* @__PURE__ */ jsxDEV(CardContent, { children: /* @__PURE__ */ jsxDEV(Box, { sx: { display: "flex", gap: 3 }, children: [
        /* @__PURE__ */ jsxDEV(ListingDetailsSection, { listing, onEdit: handleEdit, onDelete: handleDelete }, void 0, false, {
          fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
          lineNumber: 198,
          columnNumber: 15
        }, this),
        /* @__PURE__ */ jsxDEV(ListingGallerySection, { images }, void 0, false, {
          fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
          lineNumber: 199,
          columnNumber: 15
        }, this)
      ] }, void 0, true, {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
        lineNumber: 197,
        columnNumber: 13
      }, this) }, void 0, false, {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
        lineNumber: 196,
        columnNumber: 11
      }, this) }, void 0, false, {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
        lineNumber: 195,
        columnNumber: 9
      }, this),
      /* @__PURE__ */ jsxDEV(
        ReservationsSection,
        {
          reservations: reservationsWithActions,
          title: "Rezerwacje tego ogłoszenia",
          showListingTitle: false,
          showAdminDetails: true
        },
        void 0,
        false,
        {
          fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
          lineNumber: 204,
          columnNumber: 9
        },
        this
      ),
      /* @__PURE__ */ jsxDEV(
        ReviewsSection,
        {
          reviews,
          title: "Opinie",
          showListingTitle: false,
          allowEdit: true,
          onReviewUpdated: handleReviewUpdated,
          onReviewDeleted: handleReviewDeleted
        },
        void 0,
        false,
        {
          fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
          lineNumber: 210,
          columnNumber: 9
        },
        this
      )
    ] }, void 0, true, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
      lineNumber: 194,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(
      Menu,
      {
        anchorEl,
        open: Boolean(anchorEl),
        onClose: handleMenuClose,
        children: [
          /* @__PURE__ */ jsxDEV(MenuItem, { onClick: () => handleStatusChangeClick("Cancelled"), children: [
            /* @__PURE__ */ jsxDEV(CancelIcon, { sx: { mr: 1, color: "#dc3545" } }, void 0, false, {
              fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
              lineNumber: 227,
              columnNumber: 11
            }, this),
            "Anuluj rezerwację"
          ] }, void 0, true, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 226,
            columnNumber: 9
          }, this),
          selectedReservation && canMarkAsNoShow(selectedReservation) && /* @__PURE__ */ jsxDEV(MenuItem, { onClick: () => handleStatusChangeClick("NoShow"), children: [
            /* @__PURE__ */ jsxDEV(EventBusyIcon, { sx: { mr: 1, color: "#ffc107" } }, void 0, false, {
              fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
              lineNumber: 233,
              columnNumber: 13
            }, this),
            "Oznacz jako nieodbyta"
          ] }, void 0, true, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 232,
            columnNumber: 9
          }, this)
        ]
      },
      void 0,
      true,
      {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
        lineNumber: 221,
        columnNumber: 7
      },
      this
    ),
    /* @__PURE__ */ jsxDEV(
      Dialog,
      {
        open: confirmDialogOpen,
        onClose: handleCancelDialog,
        children: [
          /* @__PURE__ */ jsxDEV(DialogTitle, { children: "Potwierdź zmianę statusu" }, void 0, false, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 244,
            columnNumber: 9
          }, this),
          /* @__PURE__ */ jsxDEV(DialogContent, { children: /* @__PURE__ */ jsxDEV(DialogContentText, { children: [
            'Czy na pewno chcesz zmienić status rezerwacji na "',
            getNewStatusLabel(newStatus),
            '"?'
          ] }, void 0, true, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 246,
            columnNumber: 11
          }, this) }, void 0, false, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 245,
            columnNumber: 9
          }, this),
          /* @__PURE__ */ jsxDEV(DialogActions, { children: [
            /* @__PURE__ */ jsxDEV(Button, { onClick: handleCancelDialog, sx: { color: DARK_GRAY }, children: "Anuluj" }, void 0, false, {
              fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
              lineNumber: 251,
              columnNumber: 11
            }, this),
            /* @__PURE__ */ jsxDEV(
              Button,
              {
                onClick: handleConfirmStatusChange,
                sx: {
                  color: PRIMARY_BLUE,
                  "&:hover": {
                    backgroundColor: "rgba(13, 110, 253, 0.04)"
                  }
                },
                autoFocus: true,
                children: "Potwierdź"
              },
              void 0,
              false,
              {
                fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
                lineNumber: 254,
                columnNumber: 11
              },
              this
            )
          ] }, void 0, true, {
            fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
            lineNumber: 250,
            columnNumber: 9
          }, this)
        ]
      },
      void 0,
      true,
      {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
        lineNumber: 240,
        columnNumber: 7
      },
      this
    )
  ] }, void 0, true, {
    fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx",
    lineNumber: 193,
    columnNumber: 5
  }, this);
};
_s(AdminListingPage, "1Rbfy99gB9tmqOXfCQTdny//g3U=", false, function() {
  return [useNavigate, useParams, useAuth, useListingsApi, useReservationsApi, useReviewsApi];
});
_c = AdminListingPage;
export default AdminListingPage;
var _c;
$RefreshReg$(_c, "AdminListingPage");
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}
function $RefreshReg$(type, id) {
  return RefreshRuntime.register(type, "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/admin/AdminListingPage.jsx " + id);
}
function $RefreshSig$() {
  return RefreshRuntime.createSignatureFunctionForTransform();
}

//# sourceMappingURL=data:application/json;base64,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QUFtUU4sZUFBZUE7QUFBaUIsSUFBQTZFO0FBQUFDLGFBQUFELElBQUEiLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZU5hdmlnYXRlIiwidXNlUGFyYW1zIiwiQm94IiwiQ2FyZCIsIkNhcmRDb250ZW50IiwiQ2lyY3VsYXJQcm9ncmVzcyIsIkFsZXJ0IiwiSWNvbkJ1dHRvbiIsIk1lbnUiLCJNZW51SXRlbSIsIkRpYWxvZyIsIkRpYWxvZ1RpdGxlIiwiRGlhbG9nQ29udGVudCIsIkRpYWxvZ0NvbnRlbnRUZXh0IiwiRGlhbG9nQWN0aW9ucyIsIkJ1dHRvbiIsIk1vcmVWZXJ0SWNvbiIsIkNhbmNlbEljb24iLCJFdmVudEJ1c3lJY29uIiwiUmVzZXJ2YXRpb25zU2VjdGlvbiIsIlJldmlld3NTZWN0aW9uIiwiTGlzdGluZ0RldGFpbHNTZWN0aW9uIiwiTGlzdGluZ0dhbGxlcnlTZWN0aW9uIiwidXNlQXV0aCIsInVzZUxpc3RpbmdzQXBpIiwidXNlUmVzZXJ2YXRpb25zQXBpIiwidXNlUmV2aWV3c0FwaSIsIlBSSU1BUllfQkxVRSIsIkRBUktfR1JBWSIsInRvYXN0IiwiQWRtaW5MaXN0aW5nUGFnZSIsIl9zIiwibmF2aWdhdGUiLCJpZCIsImF1dGgiLCJnZXRMaXN0aW5nIiwiZGVsZXRlTGlzdGluZyIsImxvYWRpbmciLCJsaXN0aW5nTG9hZGluZyIsImVycm9yIiwibGlzdGluZ0Vycm9yIiwiZ2V0UmVzZXJ2YXRpb25zIiwidXBkYXRlUmVzZXJ2YXRpb25TdGF0dXMiLCJyZXNlcnZhdGlvbnNMb2FkaW5nIiwiZ2V0UmV2aWV3cyIsInJldmlld3NMb2FkaW5nIiwibGlzdGluZyIsInNldExpc3RpbmciLCJpbWFnZXMiLCJzZXRJbWFnZXMiLCJyZXZpZXdzIiwic2V0UmV2aWV3cyIsInJlc2VydmF0aW9ucyIsInNldFJlc2VydmF0aW9ucyIsImFuY2hvckVsIiwic2V0QW5jaG9yRWwiLCJzZWxlY3RlZFJlc2VydmF0aW9uIiwic2V0U2VsZWN0ZWRSZXNlcnZhdGlvbiIsImNvbmZpcm1EaWFsb2dPcGVuIiwic2V0Q29uZmlybURpYWxvZ09wZW4iLCJuZXdTdGF0dXMiLCJzZXROZXdTdGF0dXMiLCJmZXRjaERhdGEiLCJ0b2tlbiIsImxpc3RpbmdSZXN1bHQiLCJzdWNjZXNzIiwiZGF0YSIsInBob3RvcyIsImxlbmd0aCIsInJlc2VydmF0aW9uc1Jlc3VsdCIsImxpc3RpbmdJZCIsInJldmlld3NSZXN1bHQiLCJoYW5kbGVFZGl0IiwiaGFuZGxlRGVsZXRlIiwid2luZG93IiwiY29uZmlybSIsInJlc3VsdCIsImhhbmRsZVJldmlld1VwZGF0ZWQiLCJoYW5kbGVSZXZpZXdEZWxldGVkIiwiY2FuQ2hhbmdlU3RhdHVzIiwicmVzZXJ2YXRpb24iLCJzdGF0dXMiLCJ0b0xvd2VyQ2FzZSIsImNhbk1hcmtBc05vU2hvdyIsImhhbmRsZU1lbnVPcGVuIiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwiaGFuZGxlTWVudUNsb3NlIiwiaGFuZGxlU3RhdHVzQ2hhbmdlQ2xpY2siLCJoYW5kbGVDb25maXJtU3RhdHVzQ2hhbmdlIiwiaGFuZGxlQ2FuY2VsRGlhbG9nIiwiZ2V0TmV3U3RhdHVzTGFiZWwiLCJyZXNlcnZhdGlvbnNXaXRoQWN0aW9ucyIsIm1hcCIsInN0YXR1c0FjdGlvbiIsImUiLCJjb2xvciIsImJhY2tncm91bmRDb2xvciIsImRpc3BsYXkiLCJqdXN0aWZ5Q29udGVudCIsImFsaWduSXRlbXMiLCJweSIsInAiLCJtYiIsImdhcCIsIkJvb2xlYW4iLCJtciIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIkFkbWluTGlzdGluZ1BhZ2UuanN4Il0sInNvdXJjZXNDb250ZW50IjpbIu+7v2ltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZU5hdmlnYXRlLCB1c2VQYXJhbXMgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgQm94LCBDYXJkLCBDYXJkQ29udGVudCwgQ2lyY3VsYXJQcm9ncmVzcywgQWxlcnQsIEljb25CdXR0b24sIE1lbnUsIE1lbnVJdGVtLCBEaWFsb2csIERpYWxvZ1RpdGxlLCBEaWFsb2dDb250ZW50LCBEaWFsb2dDb250ZW50VGV4dCwgRGlhbG9nQWN0aW9ucywgQnV0dG9uIH0gZnJvbSAnQG11aS9tYXRlcmlhbCc7XHJcbmltcG9ydCBNb3JlVmVydEljb24gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbC9Nb3JlVmVydCc7XHJcbmltcG9ydCBDYW5jZWxJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvQ2FuY2VsJztcclxuaW1wb3J0IEV2ZW50QnVzeUljb24gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbC9FdmVudEJ1c3knO1xyXG5pbXBvcnQgeyBSZXNlcnZhdGlvbnNTZWN0aW9uLCBSZXZpZXdzU2VjdGlvbiB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvaG9zdCc7XHJcbmltcG9ydCB7IExpc3RpbmdEZXRhaWxzU2VjdGlvbiwgTGlzdGluZ0dhbGxlcnlTZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9zaGFyZWQnO1xyXG5pbXBvcnQgeyB1c2VBdXRoLCB1c2VMaXN0aW5nc0FwaSwgdXNlUmVzZXJ2YXRpb25zQXBpLCB1c2VSZXZpZXdzQXBpIH0gZnJvbSAnLi4vLi4vaG9va3MnO1xyXG5pbXBvcnQgeyBQUklNQVJZX0JMVUUsIERBUktfR1JBWSB9IGZyb20gJy4uLy4uL2Fzc2V0cy9zdHlsZXMvY29sb3JzJztcclxuaW1wb3J0IHsgdG9hc3QgfSBmcm9tICdyZWFjdC10b2FzdGlmeSc7XHJcblxyXG5jb25zdCBBZG1pbkxpc3RpbmdQYWdlID0gKCkgPT4ge1xyXG4gIGNvbnN0IG5hdmlnYXRlID0gdXNlTmF2aWdhdGUoKTtcclxuICBjb25zdCB7IGlkIH0gPSB1c2VQYXJhbXMoKTtcclxuICBjb25zdCB7IGF1dGggfSA9IHVzZUF1dGgoKTtcclxuICBjb25zdCB7XHJcbiAgICBnZXRMaXN0aW5nLFxyXG4gICAgZGVsZXRlTGlzdGluZyxcclxuICAgIGxvYWRpbmc6IGxpc3RpbmdMb2FkaW5nLFxyXG4gICAgZXJyb3I6IGxpc3RpbmdFcnJvcixcclxuICB9ID0gdXNlTGlzdGluZ3NBcGkoKTtcclxuICBjb25zdCB7IGdldFJlc2VydmF0aW9ucywgdXBkYXRlUmVzZXJ2YXRpb25TdGF0dXMsIGxvYWRpbmc6IHJlc2VydmF0aW9uc0xvYWRpbmcgfSA9IHVzZVJlc2VydmF0aW9uc0FwaSgpO1xyXG4gIGNvbnN0IHsgZ2V0UmV2aWV3cywgbG9hZGluZzogcmV2aWV3c0xvYWRpbmcgfSA9IHVzZVJldmlld3NBcGkoKTtcclxuXHJcbiAgY29uc3QgW2xpc3RpbmcsIHNldExpc3RpbmddID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2ltYWdlcywgc2V0SW1hZ2VzXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbcmV2aWV3cywgc2V0UmV2aWV3c10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Jlc2VydmF0aW9ucywgc2V0UmVzZXJ2YXRpb25zXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbYW5jaG9yRWwsIHNldEFuY2hvckVsXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZFJlc2VydmF0aW9uLCBzZXRTZWxlY3RlZFJlc2VydmF0aW9uXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtjb25maXJtRGlhbG9nT3Blbiwgc2V0Q29uZmlybURpYWxvZ09wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtuZXdTdGF0dXMsIHNldE5ld1N0YXR1c10gPSB1c2VTdGF0ZShudWxsKTtcclxuXHJcbiAgY29uc3QgZmV0Y2hEYXRhID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgaWYgKCFhdXRoPy50b2tlbiB8fCAhaWQpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBsaXN0aW5nUmVzdWx0ID0gYXdhaXQgZ2V0TGlzdGluZyhpZCwgYXV0aC50b2tlbik7XHJcbiAgICBpZiAobGlzdGluZ1Jlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIHNldExpc3RpbmcobGlzdGluZ1Jlc3VsdC5kYXRhKTtcclxuICAgICAgaWYgKGxpc3RpbmdSZXN1bHQuZGF0YS5waG90b3MgJiYgbGlzdGluZ1Jlc3VsdC5kYXRhLnBob3Rvcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgc2V0SW1hZ2VzKGxpc3RpbmdSZXN1bHQuZGF0YS5waG90b3MpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNldEltYWdlcyhbXSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXNlcnZhdGlvbnNSZXN1bHQgPSBhd2FpdCBnZXRSZXNlcnZhdGlvbnMoeyBsaXN0aW5nSWQ6IGlkIH0sIGF1dGgudG9rZW4pO1xyXG4gICAgaWYgKHJlc2VydmF0aW9uc1Jlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIHNldFJlc2VydmF0aW9ucyhyZXNlcnZhdGlvbnNSZXN1bHQuZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmV2aWV3c1Jlc3VsdCA9IGF3YWl0IGdldFJldmlld3MoeyBsaXN0aW5nSWQ6IGlkIH0sIGF1dGgudG9rZW4pO1xyXG4gICAgaWYgKHJldmlld3NSZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICBzZXRSZXZpZXdzKHJldmlld3NSZXN1bHQuZGF0YSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGZldGNoRGF0YSgpO1xyXG4gIH0sIFtpZCwgYXV0aD8udG9rZW5dKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRWRpdCA9ICgpID0+IHtcclxuICAgIG5hdmlnYXRlKGAvYWRtaW4vbGlzdGluZy8ke2lkfS9lZGl0YCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgaWYgKCF3aW5kb3cuY29uZmlybSgnQ3p5IG5hIHBld25vIGNoY2VzeiB1c3VuxIXEhyB0byBvZ8WCb3N6ZW5pZT8nKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGVsZXRlTGlzdGluZyhpZCwgYXV0aC50b2tlbik7XHJcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgdG9hc3Quc3VjY2VzcygnT2fFgm9zemVuaWUgem9zdGHFgm8gdXN1bmnEmXRlJyk7XHJcbiAgICAgIG5hdmlnYXRlKCcvYWRtaW4vbGlzdGluZ3MnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRvYXN0LmVycm9yKHJlc3VsdC5lcnJvciB8fCAnTmllIHVkYcWCbyBzacSZIHVzdW7EhcSHIG9nxYJvc3plbmlhJyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlUmV2aWV3VXBkYXRlZCA9ICgpID0+IHtcclxuICAgIGZldGNoRGF0YSgpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVJldmlld0RlbGV0ZWQgPSAoKSA9PiB7XHJcbiAgICBmZXRjaERhdGEoKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBjYW5DaGFuZ2VTdGF0dXMgPSAocmVzZXJ2YXRpb24pID0+IHtcclxuICAgIGNvbnN0IHN0YXR1cyA9IHJlc2VydmF0aW9uLnN0YXR1cz8udG9Mb3dlckNhc2UoKTtcclxuICAgIHJldHVybiBzdGF0dXMgIT09ICdjb21wbGV0ZWQnICYmIHN0YXR1cyAhPT0gJ2NhbmNlbGxlZCcgJiYgc3RhdHVzICE9PSAnbm9zaG93JztcclxuICAgIH07XHJcblxyXG4gIGNvbnN0IGNhbk1hcmtBc05vU2hvdyA9IChyZXNlcnZhdGlvbikgPT4ge1xyXG4gICAgcmV0dXJuIHJlc2VydmF0aW9uLnN0YXR1cz8udG9Mb3dlckNhc2UoKSA9PT0gJ2lucHJvZ3Jlc3MnO1xyXG4gIH07ICBcclxuXHJcbiAgY29uc3QgaGFuZGxlTWVudU9wZW4gPSAoZXZlbnQsIHJlc2VydmF0aW9uKSA9PiB7XHJcbiAgICBzZXRBbmNob3JFbChldmVudC5jdXJyZW50VGFyZ2V0KTtcclxuICAgIHNldFNlbGVjdGVkUmVzZXJ2YXRpb24ocmVzZXJ2YXRpb24pO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1lbnVDbG9zZSA9ICgpID0+IHtcclxuICAgIHNldEFuY2hvckVsKG51bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVN0YXR1c0NoYW5nZUNsaWNrID0gKHN0YXR1cykgPT4ge1xyXG4gICAgc2V0TmV3U3RhdHVzKHN0YXR1cyk7XHJcbiAgICBzZXRDb25maXJtRGlhbG9nT3Blbih0cnVlKTtcclxuICAgIGhhbmRsZU1lbnVDbG9zZSgpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNvbmZpcm1TdGF0dXNDaGFuZ2UgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBpZiAoIXNlbGVjdGVkUmVzZXJ2YXRpb24gfHwgIW5ld1N0YXR1cyB8fCAhYXV0aD8udG9rZW4pIHJldHVybjtcclxuXHJcbiAgICBzZXRDb25maXJtRGlhbG9nT3BlbihmYWxzZSk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdXBkYXRlUmVzZXJ2YXRpb25TdGF0dXMoc2VsZWN0ZWRSZXNlcnZhdGlvbi5pZCwgbmV3U3RhdHVzLCBhdXRoLnRva2VuKTtcclxuXHJcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgdG9hc3Quc3VjY2VzcygnU3RhdHVzIHJlemVyd2Fjamkgem9zdGHFgiB6YWt0dWFsaXpvd2FueScpO1xyXG4gICAgICBmZXRjaERhdGEoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRvYXN0LmVycm9yKHJlc3VsdC5lcnJvciB8fCAnTmllIHVkYcWCbyBzacSZIHpha3R1YWxpem93YcSHIHN0YXR1c3UnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRTZWxlY3RlZFJlc2VydmF0aW9uKG51bGwpO1xyXG4gICAgc2V0TmV3U3RhdHVzKG51bGwpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNhbmNlbERpYWxvZyA9ICgpID0+IHtcclxuICAgIHNldENvbmZpcm1EaWFsb2dPcGVuKGZhbHNlKTtcclxuICAgIHNldFNlbGVjdGVkUmVzZXJ2YXRpb24obnVsbCk7XHJcbiAgICBzZXROZXdTdGF0dXMobnVsbCk7XHJcbiAgfTtcclxuXHJcbiAgICBjb25zdCBnZXROZXdTdGF0dXNMYWJlbCA9IChzdGF0dXMpID0+IHtcclxuICAgICAgICBzd2l0Y2ggKHN0YXR1cykge1xyXG4gICAgICAgICAgICBjYXNlICdDYW5jZWxsZWQnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdBbnVsb3dhbmEnO1xyXG4gICAgICAgICAgICBjYXNlICdOb1Nob3cnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdOaWVvZGJ5dGEnO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXR1cztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICBjb25zdCByZXNlcnZhdGlvbnNXaXRoQWN0aW9ucyA9IHJlc2VydmF0aW9ucy5tYXAoKHJlc2VydmF0aW9uKSA9PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5yZXNlcnZhdGlvbixcclxuICAgICAgc3RhdHVzQWN0aW9uOiBjYW5DaGFuZ2VTdGF0dXMocmVzZXJ2YXRpb24pID8gKFxyXG4gICAgICAgIDxJY29uQnV0dG9uXHJcbiAgICAgICAgICBzaXplPVwic21hbGxcIlxyXG4gICAgICAgICAgb25DbGljaz17KGUpID0+IGhhbmRsZU1lbnVPcGVuKGUsIHJlc2VydmF0aW9uKX1cclxuICAgICAgICAgIHN4PXt7XHJcbiAgICAgICAgICAgIGNvbG9yOiBQUklNQVJZX0JMVUUsXHJcbiAgICAgICAgICAgICcmOmhvdmVyJzoge1xyXG4gICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTMsIDExMCwgMjUzLCAwLjA4KScsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9fVxyXG4gICAgICAgID5cclxuICAgICAgICAgIDxNb3JlVmVydEljb24gZm9udFNpemU9XCJzbWFsbFwiIC8+XHJcbiAgICAgICAgPC9JY29uQnV0dG9uPlxyXG4gICAgICApIDogbnVsbCxcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGlmIChsaXN0aW5nTG9hZGluZyB8fCByZXNlcnZhdGlvbnNMb2FkaW5nIHx8IHJldmlld3NMb2FkaW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Qm94IHN4PXt7IGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgcHk6IDEwIH19PlxyXG4gICAgICAgIDxDaXJjdWxhclByb2dyZXNzIC8+XHJcbiAgICAgIDwvQm94PlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGlmIChsaXN0aW5nRXJyb3IpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxCb3ggc3g9e3sgcDogMyB9fT5cclxuICAgICAgICA8QWxlcnQgc2V2ZXJpdHk9XCJlcnJvclwiPntsaXN0aW5nRXJyb3J9PC9BbGVydD5cclxuICAgICAgPC9Cb3g+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaWYgKCFsaXN0aW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Qm94IHN4PXt7IHA6IDMgfX0+XHJcbiAgICAgICAgPEFsZXJ0IHNldmVyaXR5PVwiaW5mb1wiPk5pZSB6bmFsZXppb25vIG9nxYJvc3plbmlhPC9BbGVydD5cclxuICAgICAgPC9Cb3g+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDw+XHJcbiAgICAgIDxCb3ggc3g9e3sgcDogMyB9fT5cclxuICAgICAgICA8Q2FyZCBzeD17eyBtYjogMyB9fT5cclxuICAgICAgICAgIDxDYXJkQ29udGVudD5cclxuICAgICAgICAgICAgPEJveCBzeD17eyBkaXNwbGF5OiAnZmxleCcsIGdhcDogMyB9fT5cclxuICAgICAgICAgICAgICA8TGlzdGluZ0RldGFpbHNTZWN0aW9uIGxpc3Rpbmc9e2xpc3Rpbmd9IG9uRWRpdD17aGFuZGxlRWRpdH0gb25EZWxldGU9e2hhbmRsZURlbGV0ZX0gLz5cclxuICAgICAgICAgICAgICA8TGlzdGluZ0dhbGxlcnlTZWN0aW9uIGltYWdlcz17aW1hZ2VzfSAvPlxyXG4gICAgICAgICAgICA8L0JveD5cclxuICAgICAgICAgIDwvQ2FyZENvbnRlbnQ+XHJcbiAgICAgICAgPC9DYXJkPlxyXG5cclxuICAgICAgICA8UmVzZXJ2YXRpb25zU2VjdGlvblxyXG4gICAgICAgICAgcmVzZXJ2YXRpb25zPXtyZXNlcnZhdGlvbnNXaXRoQWN0aW9uc31cclxuICAgICAgICAgIHRpdGxlPVwiUmV6ZXJ3YWNqZSB0ZWdvIG9nxYJvc3plbmlhXCJcclxuICAgICAgICAgIHNob3dMaXN0aW5nVGl0bGU9e2ZhbHNlfVxyXG4gICAgICAgICAgc2hvd0FkbWluRGV0YWlscz17dHJ1ZX1cclxuICAgICAgICAvPlxyXG4gICAgICAgIDxSZXZpZXdzU2VjdGlvblxyXG4gICAgICAgICAgcmV2aWV3cz17cmV2aWV3c31cclxuICAgICAgICAgIHRpdGxlPVwiT3BpbmllXCJcclxuICAgICAgICAgIHNob3dMaXN0aW5nVGl0bGU9e2ZhbHNlfVxyXG4gICAgICAgICAgYWxsb3dFZGl0PXt0cnVlfVxyXG4gICAgICAgICAgb25SZXZpZXdVcGRhdGVkPXtoYW5kbGVSZXZpZXdVcGRhdGVkfVxyXG4gICAgICAgICAgb25SZXZpZXdEZWxldGVkPXtoYW5kbGVSZXZpZXdEZWxldGVkfVxyXG4gICAgICAgIC8+XHJcbiAgICAgIDwvQm94PlxyXG5cclxuICAgICAgey8qIE1lbnUgem1pYW55IHN0YXR1c3UgKi99XHJcbiAgICAgIDxNZW51XHJcbiAgICAgICAgYW5jaG9yRWw9e2FuY2hvckVsfVxyXG4gICAgICAgIG9wZW49e0Jvb2xlYW4oYW5jaG9yRWwpfVxyXG4gICAgICAgIG9uQ2xvc2U9e2hhbmRsZU1lbnVDbG9zZX1cclxuICAgICAgPlxyXG4gICAgICAgIDxNZW51SXRlbSBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTdGF0dXNDaGFuZ2VDbGljaygnQ2FuY2VsbGVkJyl9PlxyXG4gICAgICAgICAgPENhbmNlbEljb24gc3g9e3sgbXI6IDEsIGNvbG9yOiAnI2RjMzU0NScgfX0gLz5cclxuICAgICAgICAgIEFudWx1aiByZXplcndhY2rEmVxyXG4gICAgICAgIDwvTWVudUl0ZW0+XHJcbiAgICAgICAgey8qIE5vU2hvdyB0eWxrbyBnZHkgcmV6ZXJ3YWNqYSBqZXN0IEluUHJvZ3Jlc3MgKi99XHJcbiAgICAgICAge3NlbGVjdGVkUmVzZXJ2YXRpb24gJiYgY2FuTWFya0FzTm9TaG93KHNlbGVjdGVkUmVzZXJ2YXRpb24pICYmIChcclxuICAgICAgICAgIDxNZW51SXRlbSBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTdGF0dXNDaGFuZ2VDbGljaygnTm9TaG93Jyl9PlxyXG4gICAgICAgICAgICA8RXZlbnRCdXN5SWNvbiBzeD17eyBtcjogMSwgY29sb3I6ICcjZmZjMTA3JyB9fSAvPlxyXG4gICAgICAgICAgICBPem5hY3ogamFrbyBuaWVvZGJ5dGFcclxuICAgICAgICAgIDwvTWVudUl0ZW0+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9NZW51PlxyXG5cclxuICAgICAgey8qIERpYWxvZyBwb3R3aWVyZHplbmlhICovfVxyXG4gICAgICA8RGlhbG9nXHJcbiAgICAgICAgb3Blbj17Y29uZmlybURpYWxvZ09wZW59XHJcbiAgICAgICAgb25DbG9zZT17aGFuZGxlQ2FuY2VsRGlhbG9nfVxyXG4gICAgICA+XHJcbiAgICAgICAgPERpYWxvZ1RpdGxlPlBvdHdpZXJkxbogem1pYW7EmSBzdGF0dXN1PC9EaWFsb2dUaXRsZT5cclxuICAgICAgICA8RGlhbG9nQ29udGVudD5cclxuICAgICAgICAgIDxEaWFsb2dDb250ZW50VGV4dD5cclxuICAgICAgICAgICAgQ3p5IG5hIHBld25vIGNoY2VzeiB6bWllbmnEhyBzdGF0dXMgcmV6ZXJ3YWNqaSBuYSBcIntnZXROZXdTdGF0dXNMYWJlbChuZXdTdGF0dXMpfVwiP1xyXG4gICAgICAgICAgPC9EaWFsb2dDb250ZW50VGV4dD5cclxuICAgICAgICA8L0RpYWxvZ0NvbnRlbnQ+XHJcbiAgICAgICAgPERpYWxvZ0FjdGlvbnM+XHJcbiAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9e2hhbmRsZUNhbmNlbERpYWxvZ30gc3g9e3sgY29sb3I6IERBUktfR1JBWSB9fT5cclxuICAgICAgICAgICAgQW51bHVqXHJcbiAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgb25DbGljaz17aGFuZGxlQ29uZmlybVN0YXR1c0NoYW5nZX1cclxuICAgICAgICAgICAgc3g9e3tcclxuICAgICAgICAgICAgICBjb2xvcjogUFJJTUFSWV9CTFVFLFxyXG4gICAgICAgICAgICAgICcmOmhvdmVyJzoge1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAncmdiYSgxMywgMTEwLCAyNTMsIDAuMDQpJyxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICBhdXRvRm9jdXNcclxuICAgICAgICAgID5cclxuICAgICAgICAgICAgUG90d2llcmTFulxyXG4gICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgPC9EaWFsb2dBY3Rpb25zPlxyXG4gICAgICA8L0RpYWxvZz5cclxuICAgIDwvPlxyXG4gICk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBZG1pbkxpc3RpbmdQYWdlO1xyXG4iXSwiZmlsZSI6IkM6L1VzZXJzL3dpa3RvL3NvdXJjZS9yZXBvcy9SQksxNC9hY2NvbW1vZGF0aW9uLWJvb2tpbmctYXBwL2FjY29tbW9kYXRpb24tYm9va2luZy11aS9zcmMvcGFnZXMvYWRtaW4vQWRtaW5MaXN0aW5nUGFnZS5qc3gifQ==