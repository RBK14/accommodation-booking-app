import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/pages/host/HostListingPage.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=be4f383c"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
var _s = $RefreshSig$();
import __vite__cjsImport1_react from "/node_modules/.vite/deps/react.js?v=be4f383c"; const useState = __vite__cjsImport1_react["useState"]; const useEffect = __vite__cjsImport1_react["useEffect"];
import { useNavigate, useParams } from "/node_modules/.vite/deps/react-router-dom.js?v=be4f383c";
import { Box, Card, CardContent, CircularProgress, Alert } from "/node_modules/.vite/deps/@mui_material.js?v=be4f383c";
import { ReservationsSection, ReviewsSection } from "/src/components/host/index.js";
import { ListingDetailsSection, ListingGallerySection } from "/src/components/shared/index.js";
import { useAuth, useListingsApi, useReservationsApi, useReviewsApi } from "/src/hooks/index.js";
const HostListingPage = () => {
  _s();
  const navigate = useNavigate();
  const { id } = useParams();
  const { auth } = useAuth();
  const {
    getListing,
    deleteListing,
    loading: listingLoading,
    error: listingError
  } = useListingsApi();
  const { getReservations, loading: reservationsLoading } = useReservationsApi();
  const { getReviews, loading: reviewsLoading } = useReviewsApi();
  const [listing, setListing] = useState(null);
  const [images, setImages] = useState([]);
  const [reviews, setReviews] = useState([]);
  const [reservations, setReservations] = useState([]);
  useEffect(() => {
    const fetchData = async () => {
      if (!auth?.token) return;
      const listingResult = await getListing(id, auth.token);
      if (listingResult.success) {
        setListing(listingResult.data);
        if (listingResult.data.photos && listingResult.data.photos.length > 0) {
          setImages(listingResult.data.photos);
        }
      }
      const reservationsResult = await getReservations({ listingId: id }, auth.token);
      if (reservationsResult.success) {
        setReservations(reservationsResult.data);
      }
      const reviewsResult = await getReviews({ listingId: id }, auth.token);
      if (reviewsResult.success) {
        setReviews(reviewsResult.data);
      }
    };
    fetchData();
  }, [id, auth?.token]);
  const handleEdit = () => {
    navigate(`/host/listing/${id}/edit`, { state: { listing, images } });
  };
  const handleDelete = async () => {
    if (!window.confirm("Czy na pewno chcesz usunąć tę ofertę?")) return;
    const result = await deleteListing(id, auth.token);
    if (result.success) {
      navigate("/host/listings");
    }
  };
  if (listingLoading || reservationsLoading || reviewsLoading) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { display: "flex", justifyContent: "center", alignItems: "center", height: "100%" }, children: /* @__PURE__ */ jsxDEV(CircularProgress, {}, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 69,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 68,
      columnNumber: 7
    }, this);
  }
  if (listingError) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: /* @__PURE__ */ jsxDEV(Alert, { severity: "error", children: listingError }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 77,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 76,
      columnNumber: 7
    }, this);
  }
  if (!listing) {
    return /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: /* @__PURE__ */ jsxDEV(Alert, { severity: "info", children: "Nie znaleziono oferty" }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 85,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 84,
      columnNumber: 7
    }, this);
  }
  return /* @__PURE__ */ jsxDEV(Box, { sx: { p: 3 }, children: [
    /* @__PURE__ */ jsxDEV(Card, { sx: { mb: 3 }, children: /* @__PURE__ */ jsxDEV(CardContent, { children: /* @__PURE__ */ jsxDEV(Box, { sx: { display: "flex", gap: 3 }, children: [
      /* @__PURE__ */ jsxDEV(ListingDetailsSection, { listing, onEdit: handleEdit, onDelete: handleDelete }, void 0, false, {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
        lineNumber: 95,
        columnNumber: 13
      }, this),
      /* @__PURE__ */ jsxDEV(ListingGallerySection, { images }, void 0, false, {
        fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
        lineNumber: 96,
        columnNumber: 13
      }, this)
    ] }, void 0, true, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 94,
      columnNumber: 11
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 93,
      columnNumber: 9
    }, this) }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 92,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(ReservationsSection, { reservations }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 101,
      columnNumber: 7
    }, this),
    /* @__PURE__ */ jsxDEV(ReviewsSection, { reviews }, void 0, false, {
      fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
      lineNumber: 102,
      columnNumber: 7
    }, this)
  ] }, void 0, true, {
    fileName: "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx",
    lineNumber: 91,
    columnNumber: 5
  }, this);
};
_s(HostListingPage, "so8ir1D54bqrIAmUYdbXQsiTEQY=", false, function() {
  return [useNavigate, useParams, useAuth, useListingsApi, useReservationsApi, useReviewsApi];
});
_c = HostListingPage;
export default HostListingPage;
var _c;
$RefreshReg$(_c, "HostListingPage");
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}
function $RefreshReg$(type, id) {
  return RefreshRuntime.register(type, "C:/Users/wikto/source/repos/RBK14/accommodation-booking-app/accommodation-booking-ui/src/pages/host/HostListingPage.jsx " + id);
}
function $RefreshSig$() {
  return RefreshRuntime.createSignatureFunctionForTransform();
}

//# sourceMappingURL=data:application/json;base64,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TWJDLGdCQUNzREMsb0JBQ1ZDLGFBQWE7QUFBQTtBQUFBK0MsS0FYekQ5QztBQW1HTixlQUFlQTtBQUFnQixJQUFBOEM7QUFBQUMsYUFBQUQsSUFBQSIsIm5hbWVzIjpbInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlTmF2aWdhdGUiLCJ1c2VQYXJhbXMiLCJCb3giLCJDYXJkIiwiQ2FyZENvbnRlbnQiLCJDaXJjdWxhclByb2dyZXNzIiwiQWxlcnQiLCJSZXNlcnZhdGlvbnNTZWN0aW9uIiwiUmV2aWV3c1NlY3Rpb24iLCJMaXN0aW5nRGV0YWlsc1NlY3Rpb24iLCJMaXN0aW5nR2FsbGVyeVNlY3Rpb24iLCJ1c2VBdXRoIiwidXNlTGlzdGluZ3NBcGkiLCJ1c2VSZXNlcnZhdGlvbnNBcGkiLCJ1c2VSZXZpZXdzQXBpIiwiSG9zdExpc3RpbmdQYWdlIiwiX3MiLCJuYXZpZ2F0ZSIsImlkIiwiYXV0aCIsImdldExpc3RpbmciLCJkZWxldGVMaXN0aW5nIiwibG9hZGluZyIsImxpc3RpbmdMb2FkaW5nIiwiZXJyb3IiLCJsaXN0aW5nRXJyb3IiLCJnZXRSZXNlcnZhdGlvbnMiLCJyZXNlcnZhdGlvbnNMb2FkaW5nIiwiZ2V0UmV2aWV3cyIsInJldmlld3NMb2FkaW5nIiwibGlzdGluZyIsInNldExpc3RpbmciLCJpbWFnZXMiLCJzZXRJbWFnZXMiLCJyZXZpZXdzIiwic2V0UmV2aWV3cyIsInJlc2VydmF0aW9ucyIsInNldFJlc2VydmF0aW9ucyIsImZldGNoRGF0YSIsInRva2VuIiwibGlzdGluZ1Jlc3VsdCIsInN1Y2Nlc3MiLCJkYXRhIiwicGhvdG9zIiwibGVuZ3RoIiwicmVzZXJ2YXRpb25zUmVzdWx0IiwibGlzdGluZ0lkIiwicmV2aWV3c1Jlc3VsdCIsImhhbmRsZUVkaXQiLCJzdGF0ZSIsImhhbmRsZURlbGV0ZSIsIndpbmRvdyIsImNvbmZpcm0iLCJyZXN1bHQiLCJkaXNwbGF5IiwianVzdGlmeUNvbnRlbnQiLCJhbGlnbkl0ZW1zIiwiaGVpZ2h0IiwicCIsIm1iIiwiZ2FwIiwiX2MiLCIkUmVmcmVzaFJlZyQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZXMiOlsiSG9zdExpc3RpbmdQYWdlLmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VOYXZpZ2F0ZSwgdXNlUGFyYW1zIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB7IEJveCwgQ2FyZCwgQ2FyZENvbnRlbnQsIENpcmN1bGFyUHJvZ3Jlc3MsIEFsZXJ0IH0gZnJvbSAnQG11aS9tYXRlcmlhbCc7XHJcbmltcG9ydCB7IFJlc2VydmF0aW9uc1NlY3Rpb24sIFJldmlld3NTZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9ob3N0JztcclxuaW1wb3J0IHsgTGlzdGluZ0RldGFpbHNTZWN0aW9uLCBMaXN0aW5nR2FsbGVyeVNlY3Rpb24gfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3NoYXJlZCc7XHJcbmltcG9ydCB7IHVzZUF1dGgsIHVzZUxpc3RpbmdzQXBpLCB1c2VSZXNlcnZhdGlvbnNBcGksIHVzZVJldmlld3NBcGkgfSBmcm9tICcuLi8uLi9ob29rcyc7XHJcblxyXG5jb25zdCBIb3N0TGlzdGluZ1BhZ2UgPSAoKSA9PiB7XHJcbiAgY29uc3QgbmF2aWdhdGUgPSB1c2VOYXZpZ2F0ZSgpO1xyXG4gIGNvbnN0IHsgaWQgfSA9IHVzZVBhcmFtcygpO1xyXG4gIGNvbnN0IHsgYXV0aCB9ID0gdXNlQXV0aCgpO1xyXG4gIGNvbnN0IHtcclxuICAgIGdldExpc3RpbmcsXHJcbiAgICBkZWxldGVMaXN0aW5nLFxyXG4gICAgbG9hZGluZzogbGlzdGluZ0xvYWRpbmcsXHJcbiAgICBlcnJvcjogbGlzdGluZ0Vycm9yLFxyXG4gIH0gPSB1c2VMaXN0aW5nc0FwaSgpO1xyXG4gIGNvbnN0IHsgZ2V0UmVzZXJ2YXRpb25zLCBsb2FkaW5nOiByZXNlcnZhdGlvbnNMb2FkaW5nIH0gPSB1c2VSZXNlcnZhdGlvbnNBcGkoKTtcclxuICBjb25zdCB7IGdldFJldmlld3MsIGxvYWRpbmc6IHJldmlld3NMb2FkaW5nIH0gPSB1c2VSZXZpZXdzQXBpKCk7XHJcblxyXG4gIGNvbnN0IFtsaXN0aW5nLCBzZXRMaXN0aW5nXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtpbWFnZXMsIHNldEltYWdlc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Jldmlld3MsIHNldFJldmlld3NdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtyZXNlcnZhdGlvbnMsIHNldFJlc2VydmF0aW9uc10gPSB1c2VTdGF0ZShbXSk7XHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBjb25zdCBmZXRjaERhdGEgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGlmICghYXV0aD8udG9rZW4pIHJldHVybjtcclxuXHJcbiAgICAgIGNvbnN0IGxpc3RpbmdSZXN1bHQgPSBhd2FpdCBnZXRMaXN0aW5nKGlkLCBhdXRoLnRva2VuKTtcclxuICAgICAgaWYgKGxpc3RpbmdSZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgIHNldExpc3RpbmcobGlzdGluZ1Jlc3VsdC5kYXRhKTtcclxuXHJcbiAgICAgICAgaWYgKGxpc3RpbmdSZXN1bHQuZGF0YS5waG90b3MgJiYgbGlzdGluZ1Jlc3VsdC5kYXRhLnBob3Rvcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBzZXRJbWFnZXMobGlzdGluZ1Jlc3VsdC5kYXRhLnBob3Rvcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXNlcnZhdGlvbnNSZXN1bHQgPSBhd2FpdCBnZXRSZXNlcnZhdGlvbnMoeyBsaXN0aW5nSWQ6IGlkIH0sIGF1dGgudG9rZW4pO1xyXG4gICAgICBpZiAocmVzZXJ2YXRpb25zUmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICBzZXRSZXNlcnZhdGlvbnMocmVzZXJ2YXRpb25zUmVzdWx0LmRhdGEpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXZpZXdzUmVzdWx0ID0gYXdhaXQgZ2V0UmV2aWV3cyh7IGxpc3RpbmdJZDogaWQgfSwgYXV0aC50b2tlbik7XHJcbiAgICAgIGlmIChyZXZpZXdzUmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICBzZXRSZXZpZXdzKHJldmlld3NSZXN1bHQuZGF0YSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgZmV0Y2hEYXRhKCk7XHJcbiAgfSwgW2lkLCBhdXRoPy50b2tlbl0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVFZGl0ID0gKCkgPT4ge1xyXG4gICAgbmF2aWdhdGUoYC9ob3N0L2xpc3RpbmcvJHtpZH0vZWRpdGAsIHsgc3RhdGU6IHsgbGlzdGluZywgaW1hZ2VzIH0gfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgaWYgKCF3aW5kb3cuY29uZmlybSgnQ3p5IG5hIHBld25vIGNoY2VzeiB1c3VuxIXEhyB0xJkgb2ZlcnTEmT8nKSkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRlbGV0ZUxpc3RpbmcoaWQsIGF1dGgudG9rZW4pO1xyXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIG5hdmlnYXRlKCcvaG9zdC9saXN0aW5ncycpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGlmIChsaXN0aW5nTG9hZGluZyB8fCByZXNlcnZhdGlvbnNMb2FkaW5nIHx8IHJldmlld3NMb2FkaW5nKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Qm94IHN4PXt7IGRpc3BsYXk6ICdmbGV4JywganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgaGVpZ2h0OiAnMTAwJScgfX0+XHJcbiAgICAgICAgPENpcmN1bGFyUHJvZ3Jlc3MgLz5cclxuICAgICAgPC9Cb3g+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaWYgKGxpc3RpbmdFcnJvcikge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPEJveCBzeD17eyBwOiAzIH19PlxyXG4gICAgICAgIDxBbGVydCBzZXZlcml0eT1cImVycm9yXCI+e2xpc3RpbmdFcnJvcn08L0FsZXJ0PlxyXG4gICAgICA8L0JveD5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBpZiAoIWxpc3RpbmcpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxCb3ggc3g9e3sgcDogMyB9fT5cclxuICAgICAgICA8QWxlcnQgc2V2ZXJpdHk9XCJpbmZvXCI+TmllIHpuYWxlemlvbm8gb2ZlcnR5PC9BbGVydD5cclxuICAgICAgPC9Cb3g+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxCb3ggc3g9e3sgcDogMyB9fT5cclxuICAgICAgPENhcmQgc3g9e3sgbWI6IDMgfX0+XHJcbiAgICAgICAgPENhcmRDb250ZW50PlxyXG4gICAgICAgICAgPEJveCBzeD17eyBkaXNwbGF5OiAnZmxleCcsIGdhcDogMyB9fT5cclxuICAgICAgICAgICAgPExpc3RpbmdEZXRhaWxzU2VjdGlvbiBsaXN0aW5nPXtsaXN0aW5nfSBvbkVkaXQ9e2hhbmRsZUVkaXR9IG9uRGVsZXRlPXtoYW5kbGVEZWxldGV9IC8+XHJcbiAgICAgICAgICAgIDxMaXN0aW5nR2FsbGVyeVNlY3Rpb24gaW1hZ2VzPXtpbWFnZXN9IC8+XHJcbiAgICAgICAgICA8L0JveD5cclxuICAgICAgICA8L0NhcmRDb250ZW50PlxyXG4gICAgICA8L0NhcmQ+XHJcblxyXG4gICAgICA8UmVzZXJ2YXRpb25zU2VjdGlvbiByZXNlcnZhdGlvbnM9e3Jlc2VydmF0aW9uc30gLz5cclxuICAgICAgPFJldmlld3NTZWN0aW9uIHJldmlld3M9e3Jldmlld3N9IC8+XHJcbiAgICA8L0JveD5cclxuICApO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgSG9zdExpc3RpbmdQYWdlO1xyXG4iXSwiZmlsZSI6IkM6L1VzZXJzL3dpa3RvL3NvdXJjZS9yZXBvcy9SQksxNC9hY2NvbW1vZGF0aW9uLWJvb2tpbmctYXBwL2FjY29tbW9kYXRpb24tYm9va2luZy11aS9zcmMvcGFnZXMvaG9zdC9Ib3N0TGlzdGluZ1BhZ2UuanN4In0=